# 컴퓨터 구조와 어셈블리 언어(2장)
![image](https://github.com/user-attachments/assets/15cd8e2b-8ec6-4da6-b072-0b88999829c4)
- 위 그림은 하드웨어 회로 상에서 주소가 할당된 예를 보여준다.
- CPU는 각 장치를 담당하는 제어기(Controller)에 적절한 명령을 전달하고, 그 결과를 읽어온다.
- 각 입출력 제어기에는 CPU로부터 명령을 받고 결과를 반환하기 위한 주소가 할당되어 있는데, 이것은 하드웨어 설계 단계에서 설계자가 적절히 선택하여 설계에 반영한다.
### CPU(Central Processing Unit)
- 중앙 처리 장치로서, 연산, 제어, 입출력 관리, 명령 해석, 메모리 접근 등을 수행하는 컴퓨터 시스템의 핵심 부품
### 데이터 흐름
1. 메모리에서 명령어나 데이터를 읽어온다.
2. CPU가 그것을 해석하고 처리한다.
3. 필요 시, 입출력 장치 제어기(I/O Controller)에 명령을 전달한다.
4. 입출력 장치와의 데이터 송수신을 담당하는 건 제어기(Controller)이다.
### 시스템 버스(System Bus)
- 버스는 단순 선이 아닌, 데이터 전송을 위한 신호들의 묶음이다.
  ### 세 가지 구성 요소
  - 주소 버스(Address Bus): 어디(메모리나 장치)에 접근할 것인지 주솔르 지정한다.
  - 데이터 버스(Data Bus): 실제 데이터를 전달한다.
  - 제어 버스(Control Bus): 읽기/쓰기 신호, 인터럽트, 클럭 등 제어 신호를 전달한다. 
### 주소 디코딩
- 주소 버스(Address Bus)의 값을 받아, 특정한 메모리 블록 또는 입출력 장치를 선택하는 회로이다.
- 즉, CPU가 특정 주소에 접근했을 때 그 주소가 어떤 장치에 해당하는지를 판단하고, 해당 장치에 연결된 회로만 활성화(선택)된다는 의미이다.
- 각 구성모듈들에 대해 일정한 주소 영역이 할당되어 있어서 CPU로부터 주소가 나오면 구성모듈들 중에서 오직 하나만이 선택되어 활성화된다.
- 주소 디코더(Address Decoder)들은 할당된 주소에 맞게 조합 논리회로(현재 입력에 따라 출력이 항상 똑같이 결정되는 논리회로)로 구성되는데, 할당된 주소영역이 적용될 때에만 출력을 활성화하여 해당 모듈이 활성화 되도록 한다.

![image](https://github.com/user-attachments/assets/dbeb738a-3119-4171-bb35-58b3098c0dc2)

### 주소 맵(Address Map or Memory Map)
- 각 모듈별로 할당된 주소의 집합

![image](https://github.com/user-attachments/assets/a8ede196-864c-4cdd-91f8-167cff692d05)

- A(19-0): 20개의 구리선으로 구성된다.
- 예를 들어, 주소 맵이 RAM은 0x00000번지부터 0x3ffff번까지 256K 바이트 크기를 가지고, ROM은 0x40000 번지부터 0x4ffff번지까지 64K 바이트의 크기를 가지며, I/O 장치는 0x80000번지부터 0x80003번지까지 4바이트의 크기를 가질 경우를 가정하면 각 대상별 주소 범위는 위의 첫째 그림과 같고 이에 따른 주소 디코더는 위의 그림과 같이 구성 할 수 있다.

![image](https://github.com/user-attachments/assets/cab51f7b-b506-4ca1-bf3a-613f4eb9f37e)

### 입출력 장치 제어
![image](https://github.com/user-attachments/assets/ae051509-52bf-49c6-8fb2-8c565141a0f0)
- 명령전달: 장치의 종류에 상관없이 보낼 수 있다.
- 작업완료 확인:
  - Polling(장치의 상태 메시지를 계속 확인한다.)
  - Interrupt
- 데이터 입출력 

### 입출력 장치 제어기를 구성하는 요소
- **제어 레지스터**: CPU로부터 명령을 받아들인다.
- **상태 레지스터**: 장치의 상태를 나타낸다.
- **데이터 레지스터**: 입출력 데이터를 처리한다.
### 입출력 장치 제어는 어떤 원리로 작동하는가?
1. CPU가 특정 입출력 장치 제어기의 제어 레지스터에 특정 명령을 의미하는 값을 기록한다.
2. 해당 제어기는 그 값을 확인하고, 지정된 작업을 수행한 후에 결과를 상태 레지스터에 기록해 둔다.
3. CPU는 이것을 읽어내어서 작업 결과를 확인할 수 있게 되며, 입출력 데이터 자체는 데이터 레지스터 부분을 읽거나 기록하는 것으로 처리한다.

### 작업 완료 확인 방법
1. **폴링(Polling)**
  - CPU는 명령을 전달한 후에 반복적으로 상태 레지스터를 읽어 보고 완료 여부를 확인한다.
  - 실행이 완료될 때까지 계속 검사를 해야 하므로 인터럽트 방식에 비해 시간 낭비를 초래한다.**(폴링 방식의 단점!)**
2. **인터럽트(Interrupt)**
  - CPU는 명령을 전달한 후에 작업이 완료될 때까지 다른 프로세스를 실행한다.
  - 명령을 받은 제어기는 지시받은 작업이 완료되는 시점에 CPU에 인터럽트 신호를 발생시킨다.
  - 이 신호에 따라 CPU는 해당 인터럽트 처리 루틴을 실행하게 되고, 여기서 작업 결과를 확인하는 절차를 실행한다.

### Direct Memory Access
![image](https://github.com/user-attachments/assets/3dab4505-7604-45b6-8fbb-35327d3da3b5)
- 디스크 입출력과 같이 한번에 대량의 데이터를 처리해야 하는 경우, 매 데이터 단위마다 CPU가 명령을 전달하고, 결과를 받는 과정을 거친다면 실행 속도가 많이 느려지게 된다.
### DMA 제어기(DMAC: Direct Memory Access Controller)
- 이러한 반복적인 작업을 전담하는 장치로서, 입력 작업을 위해서는 직접 주변 장치의 제어기로부터 데이터를 받아서 메모리의 지정된 영역에 차례대로 기록하고, 출력 작업을 위해서는 그 반대의 작업을 실행한다.
- 즉, 메모리에는 CPU뿐만 아니라 DMAC도 읽거나 쓰기 작업을 실행한다.
